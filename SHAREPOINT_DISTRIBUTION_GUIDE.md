# SharePointでの配布方法

## SharePointへのアップロード手順

### 前提条件
- Microsoft 365 Business Basic プラン
- SharePointの管理者権限またはファイルアップロード権限

---

## 推奨配布方法

### オプション1: ドキュメントライブラリで配布（推奨）

#### 手順

1. **SharePointサイトにアクセス**
   - チームサイトまたは部門サイトを開く

2. **専用フォルダを作成**
   - ドキュメントライブラリに移動
   - 「新規」→「フォルダ」をクリック
   - フォルダ名: `社内ツール` または `PDF編集ツール`

3. **インストーラーをアップロード**
   - 作成したフォルダを開く
   - 「アップロード」→「ファイル」をクリック
   - `PDF編集ツール-1.0.0-Setup.exe` を選択
   - アップロード完了を待つ（約150-200MB、数分かかります）

4. **説明文書をアップロード**
   - `USER_INSTALL_GUIDE.md` をアップロード
   - または、SharePointページで説明文を作成

5. **権限設定**
   - ファイルを右クリック→「詳細の管理」
   - 「共有」タブで社員に読み取り権限を付与
   - ダウンロード権限があることを確認

---

### オプション2: SharePointページで配布

#### 手順

1. **新しいSharePointページを作成**
   - 「新規」→「ページ」をクリック
   - ページ名: `PDF編集ツール - インストールガイド`

2. **ページの構成**
   ```
   # PDF編集ツール

   ## 概要
   PDFファイルの表示、統合、分割ができる社内ツールです。

   ## 機能
   - PDF表示（ページめくり、ズーム）
   - PDF統合（複数ファイルを1つに結合）
   - PDF分割（1つのファイルを複数に分割）

   ## ダウンロード
   [最新版をダウンロード（v1.0.0）](リンク)

   ## インストール手順
   1. 上記のリンクからインストーラーをダウンロード
   2. ダウンロードしたファイルをダブルクリック
   3. インストールウィザードに従ってインストール

   ## 詳しい使い方
   [インストール・使用方法の詳細](リンク)
   ```

3. **インストーラーをリンク**
   - ファイルWebパーツを追加
   - `PDF編集ツール-1.0.0-Setup.exe` を選択
   - または、ダウンロードリンクを作成

4. **ページを公開**
   - 「公開」ボタンをクリック
   - 社員がアクセスできることを確認

---

## ダウンロードリンクの共有方法

### 直接リンクを取得

1. SharePointでファイルを右クリック
2. 「リンクのコピー」をクリック
3. 「組織内のユーザー」を選択
4. リンクをメールやTeamsで共有

### メールでの案内文例

```
件名: 【社内ツール】PDF編集ツール - インストールのご案内

社員各位

PDFファイルの統合・分割が簡単にできる社内ツールを導入しました。

▼ ダウンロード
[SharePointリンク]

▼ 機能
・PDF表示（ページめくり、ズーム）
・PDF統合（複数のPDFを1つに結合）
・PDF分割（1つのPDFを複数に分割）

▼ インストール方法
1. 上記のリンクからインストーラーをダウンロード
2. ダウンロードしたファイルをダブルクリック
3. インストールウィザードに従って進める

詳しい使い方は添付の「インストール手順書」をご覧ください。

ご不明な点がございましたら、お気軽にお問い合わせください。

以上
```

---

## セキュリティ設定

### ファイルのウイルススキャン

SharePointは自動的にアップロードされたファイルをスキャンします。
ただし、大きなファイル（150MB以上）の場合、スキャンに時間がかかることがあります。

### ダウンロード制限

特定の部門やユーザーのみがダウンロードできるように制限する場合：

1. ファイルを右クリック→「詳細の管理」
2. 「共有」タブを開く
3. 「直接アクセス権の付与」で特定のユーザー/グループを指定
4. 権限レベルを「読み取り」に設定

---

## バージョン管理

### 新しいバージョンのアップロード方法

1. **新しいバージョンをビルド**
   - Windows PCで `npm run build:win` を実行
   - バージョン番号を更新した場合、ファイル名も変わります

2. **SharePointにアップロード**
   - オプションA: 古いファイルを削除して新しいファイルをアップロード
   - オプションB: 新しいファイルを追加し、古いファイルは「アーカイブ」フォルダに移動

3. **バージョン履歴を記録**
   ```
   フォルダ構成例:
   社内ツール/
   ├── PDF編集ツール-1.0.0-Setup.exe  ← 最新版
   ├── PDF編集ツール-1.1.0-Setup.exe  ← 次のバージョン
   └── アーカイブ/
       └── PDF編集ツール-0.9.0-Setup.exe  ← 旧バージョン
   ```

4. **社員への通知**
   - メールまたはTeamsで更新を通知
   - 変更内容を簡潔に説明

---

## トラブルシューティング

### アップロードが失敗する

**原因:** ファイルサイズが大きすぎる

**対処法:**
- ファイルサイズ制限を確認（通常は最大15GB）
- ブラウザのキャッシュをクリア
- 別のブラウザで試す

### ダウンロードが遅い

**原因:** SharePointのネットワーク速度

**対処法:**
- オフピーク時間にダウンロード
- 社内ネットワークから直接ダウンロード

### Windows Defenderが警告を表示

**原因:** 署名されていない.exeファイル

**対処法:**
- 社員向けに説明文書で対処方法を案内
- IT部門に例外設定を依頼
- コード署名証明書の取得を検討（オプション）

---

## おすすめの運用方法

### 定期的な更新確認
- 月1回、バグ修正や機能改善をチェック
- 必要に応じてバージョンアップ

### フィードバック収集
- SharePointページにコメント機能を有効化
- または、Formsでフィードバックフォームを作成

### 利用状況の確認
- SharePointの分析機能でダウンロード数を確認
- 利用が少ない場合は、使い方の説明会を開催
